'use strict';var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h['return']&&h['return']()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}();function SmartJS(a,b){var c=_slicedToArray(b,2),d=c[0],e=c[1],f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},g=this,h=window,i=function(a,b){return console.log('[SmartJS]'+(b?' ['+b+'] ':' ')+': ',a)};h.log=i;var j=function(a){var b=decodeURI(a.stack.replace(/(@|[\(\)]|[\w]+:\/\/)/g,'')).split(/\n/);b=''==b[2]?b[0]:b[1].split('/'),b=b[b.length-1].split(':'),i(''+a.toString()+'\n file : '+b[0]+'\n line : '+b[1]+'\n symbol : '+b[2])},k=!1,l=!1,m={globalAplha:1,globalCompositeOperation:'source-over',lineCap:'square',lineJoin:'round',textBaseline:'middle',font:'14px sans-serif',fillStyle:'#f1f1f1',strokeStyle:'#f6f6f6'},d=d,e=e;h.addEventListener('load',function(){n.runEvent('load')});var n={eventCount:0,topic:{load:[],beforeEng:[],afterEng:[]},addEvent:function addEvent(a,b,c){this.topic.hasOwnProperty(a)||'string'!=typeof a||(this.topic[a]=[]),this.topic[a].push({func:c,key:b}),this.eventCount+=1},delEvent:function delEvent(a,b){var c=this,d=2<arguments.length&&arguments[2]!==void 0&&arguments[2];this.topic.hasOwnProperty(a)&&this.topic[object.event].forEach(function(e,f){e.key===b&&(c.topic[a].splice(f,1),c.eventCount-=1,d&&delete c.topic[a])})},runEvent:function runEvent(a,b){if(!this.topic.hasOwnProperty(a))return!1;if(void 0!==b)this.topic[a].forEach(function(a){a.key===b&&setTimeout(a.func,0)});else for(var c=this.topic[a],d=c.length;d--;)setTimeout(c[d].func,0)}};n.addEvent('load','dom',function(){k=!0,A(y)}),this.game=Object.create(null),this.system=Object.create(null),this.event=Object.create(null),this.event.addEvent=function(a,b){n.addEvent(a,b)},this.event.delEvent=function(a,b){n.delEvent(a,b)},this.event.runEvent=function(a){n.runEvent(a)},this.event.eventCount=function(){return n.eventCount},this.system.setDefaultSetting=function(){for(var a in m)z[a]=m[a];z.save()},this.system.setSetting=function(a){for(var b in a)m.hasOwnProperty(b)&&(m[b]=a[b])};var o=60,p={},q=1/o,r=Date.now(),s=0,t=0,u=function(){if(k&&l)try{for(r=Date.now(),t+=Math.min(1,(r-s)/1e3);t>q;)v.update(t),t-=q;v.render(),s=r}catch(a){return void j(a)}x(u)},v={update:function update(){i('please use \'startLoop\' for game start')},redner:function redner(){},entry:!1,exit:!1},w=function(){return h.requestAnimationFrame||h.mozRequestAnimationFrame||h.webkitRequestAnimationFrame||h.oRequestAnimationFrame||function(a){setTimeout(a,1e3/o)}},x=w();this.game.getLoop=function(a){return!!(a in p)&&p[a]},this.game.newLoop=function(a,b,c,d,e){p.hasOwnProperty(a)||(p[a]={update:b,render:c,entry:d||!1,exit:e||!1})},this.game.newLoopFromConstructor=function(a,b){var c=new b;c.hasOwnProperty(a)||(p[a]={update:c.update,render:c.render,entry:c.entry||!1,exit:c.exit||!1})},this.game.newLoopFromClassObject=function(a,b){!p.hasOwnProperty(a)&&b.update&&b.render&&(p[a]={update:b.update,render:b.render,entry:b.entry||!1,exit:b.exit||!1})},this.game.setLoop=function(a){a in p&&(v=p[a])},this.game.startLoop=function(a){this.setLoop(a),this.start()},this.game.start=function(){return l?i('loop is totaly runned','Game'):void(l=!0,u())},this.game.stop=function(){l?(x=function(){i('game is stop','Game')},l=!1):i('game have already stopped','Game')},this.game.resume=function(){l||(x=w(),this.start())},this.game.getDT=function(){return t},this.game.getContext=function(){return!!k&&z},this.game.getFPS=function(){return o},this.game.setFPS=function(a){o=30<=a&&120>=a?a:60};var y=document.createElement('canvas'),z=y.getContext(a.toLowerCase());y.width=d,y.height=e,y.style.backgroundColor=f.background||'silver';var A=function(a){document.body.appendChild(a),a.style.position='fixed',a.style.left='0px',a.style.top='0px',a.style.overflow='hidden',a.style.zIndex='1000'}}SmartJS.prototype=Object.prototype;